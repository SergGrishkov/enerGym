{"version":3,"file":"commonHelpers.js","sources":["../src/helpers/render.js","../src/js/favorites.js"],"sourcesContent":["import { firstLetterToUpper } from './utils';\n\nexport function renderFavoriteCards(arrayCards) {\n  if (arrayCards) {\n    return arrayCards.reduce((acc, prev) => {\n      return (\n        acc +\n        `\n    <li class=\"favorite-item\" data-exerciseId=\"${prev._id}\">\n                <div class=\"favorite-label-drop-start\">\n                    <p class=\"favorite-label-workout\">WORKOUT</p>\n                    <button class=\"favorite-remove-btn\">\n                        <svg class=\"remove-favorites\" width=\"16\" height=\"16\" aria-label=\"icon-bucket\">\n                          <use href=\"./sprite.svg#icon-remove-favorites\"></use>\n                        </svg>\n                    </button>\n                    <button class=\"favorite-start-btn\">Start\n                        <svg class=\"favorites-icon\" width=\"14\" height=\"14\" aria-label=\"start-arrow\">\n                            <use href=\"./sprite.svg#icon-exercises-arrow\"></use>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"favorite-label-icon-run\">\n                    <svg class=\"favorite-icon-run\" width=\"24\" height=\"24\" aria-label=\"icon-bucket\">\n                        <use href=\"./sprite.svg#icon-exercises-man\"></use>\n                    </svg>\n                    <p>${firstLetterToUpper(prev.name)}</p>\n                </div>\n                <div class=\"favorite-label-burn\">\n                    <p>Burned calories:</p>\n                    <span>${prev.burnedCalories} / ${prev.time} min</span>\n                    <p>Body part:</p>\n                    <span>${firstLetterToUpper(prev.bodyPart)}</span>\n                    <p>Target:</p>\n                    <span>${firstLetterToUpper(prev.target)}</span>\n                </div>\n            </li>\n    `\n      );\n    }, '');\n  } else {\n    return `\n    <div class=\"missing-cards\">\n            <img src=\"./dumbbell@1x.png\" alt=\"dumbbell-img\">\n            <p>It appears that you haven't added any exercises to your favorites yet. To get started, you can add\n                exercises that you\n                like to your favorites for easier access in the future.</p>\n        </div>\n    `;\n  }\n}\n","import { ExercisesController } from '../api/controllers/ExercisesController';\nimport { renderFavoriteCards } from '../helpers/render';\nimport {\n  getFavoritCardsFromLocalStorage,\n  isExerciseInFavorite,\n  removeExerciseFromFavoriteById,\n} from '../helpers/locatStorage';\nimport { splitArraytoParts } from '../helpers/utils';\nimport { renderPagination } from './pagination';\nimport { createMarkupModalEx } from './modal-exercise.js';\n\nconst exerciseCntrl = new ExercisesController();\nlet exercise;\nconst chunk = 8;\n\nconst listFavorites = document.querySelector(\n  '.favorites-container-content-items'\n);\nconst paginationList = document.querySelector('.pagination-list');\nconst modalWindow = document.querySelector('.backdrop');\nconst body = document.body;\nlet btnAddRemoveEl;\n\nconst chunkArrayLs = splitArraytoParts(\n  getFavoritCardsFromLocalStorage(),\n  chunk\n);\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  if (window.innerWidth <= 767) {\n    let cards = splitArraytoParts(getFavoritCardsFromLocalStorage(), chunk)[0];\n    listFavorites.innerHTML = renderFavoriteCards(cards);\n    paginationList.innerHTML = renderPagination(chunkArrayLs.length, 1);\n  } else {\n    const favoriteInfoLs = renderFavoriteCards(\n      getFavoritCardsFromLocalStorage()\n    );\n    listFavorites.innerHTML = favoriteInfoLs;\n  }\n});\n\nwindow.addEventListener('resize', () => {\n  if (window.matchMedia('(max-width: 767px)').matches) {\n    let chunkArrayLocal = splitArraytoParts(\n      getFavoritCardsFromLocalStorage(),\n      chunk\n    );\n    let cards = splitArraytoParts(getFavoritCardsFromLocalStorage(), chunk)[0];\n    listFavorites.innerHTML = renderFavoriteCards(cards);\n    paginationList.innerHTML = renderPagination(chunkArrayLocal.length, 1);\n  } else {\n    const favoriteInfoLs = renderFavoriteCards(\n      getFavoritCardsFromLocalStorage()\n    );\n    listFavorites.innerHTML = favoriteInfoLs;\n    paginationList.innerHTML = '';\n  }\n});\n\nlistFavorites.addEventListener('click', async e => {\n  if (\n    e.target.ariaLabel !== 'icon-bucket' &&\n    e.target.className !== 'favorite-remove-btn' &&\n    e.target.className !== 'favorite-start-btn' &&\n    e.target.ariaLabel !== 'start-arrow'\n  )\n    return;\n\n  let id = Object.values(e.target.closest('[data-exerciseId]').dataset)[0];\n\n  if (\n    e.target.ariaLabel === 'icon-bucket' ||\n    e.target.className === 'favorite-remove-btn'\n  ) {\n    let allstorage;\n    try {\n      if (isExerciseInFavorite(id)) {\n        removeExerciseFromFavoriteById(id);\n        document.querySelector(`[data-exerciseId=\"${id}\"]`).remove();\n        allstorage = getFavoritCardsFromLocalStorage()\n          ? getFavoritCardsFromLocalStorage().length\n          : 0;\n        if (allstorage % chunk === 0) {\n          paginationList.innerHTML = renderPagination(chunkArrayLs.length, 1);\n          window.location.reload();\n        }\n        if (allstorage === 0) {\n          paginationList.innerHTML = '';\n          window.location.reload();\n        }\n      }\n    } catch (error) {\n      console.log(`Exercise with ${id} can't be removed`, error);\n    }\n  }\n\n  if (\n    e.target.className === 'favorite-start-btn' ||\n    e.target.ariaLabel === 'start-arrow'\n  ) {\n    const exerciseInfo = await exerciseCntrl.getExerciseById(id);\n    createMarkupModalEx(exerciseInfo.json());\n    btnAddRemoveEl = document.querySelector('.js-add-remove-btn');\n    btnAddRemoveEl.addEventListener('click', e => {\n      if (\n        window.location.pathname !== '/favorites.html' &&\n        e.target.classList.contains('js-add-remove-btn')\n      )\n        return;\n      if (e.target.innerText.trim() === 'Remove from favorites') {\n        document.querySelector(`[data-exerciseId=\"${id}\"]`).remove();\n      }\n    });\n  }\n});\n\npaginationList.addEventListener('click', getCurrentPage);\n\nfunction getCurrentPage(event) {\n  if (event.target.tagName === 'LI') {\n    paginationList.innerHTML = renderPagination(\n      chunkArrayLs.length,\n      event.target.value\n    );\n    listFavorites.innerHTML = renderFavoriteCards(\n      chunkArrayLs[event.target.value - 1]\n    );\n  }\n}\n\nconst closeIconUse = document.querySelector('.modal-close-icon use');\n\nfunction closeModalOnEscape(event) {\n  if (event.key === 'Escape') {\n    closeExerciseModal(); \n  }\n}\n\nfunction closeExerciseModal() {\n  modalWindow.classList.remove('is-open');\n  body.classList.remove('modal-open');\n  window.removeEventListener('keydown', closeModalOnEscape);\n  window.removeEventListener('click', closeModalOnMouse);\n  const favoriteInfoLs = renderFavoriteCards(getFavoritCardsFromLocalStorage());\n  listFavorites.innerHTML = favoriteInfoLs;\n}\n\nfunction closeModalOnMouse(e) {\n  e.preventDefault();\n\n  if (\n    e.target.classList.value === 'close-btn' ||\n    e.target.classList.value === 'modal-close-icon' ||\n    e.target.classList.value === 'backdrop is-open'\n  ) {\n    closeExerciseModal();\n  }\n}\n\ncloseIconUse.addEventListener('click', function () {\n  closeExerciseModal();\n});\n\nwindow.addEventListener('keydown', function () {\n  closeExerciseModal();\n});\n"],"names":["renderFavoriteCards","arrayCards","acc","prev","firstLetterToUpper","exerciseCntrl","ExercisesController","chunk","listFavorites","paginationList","modalWindow","body","btnAddRemoveEl","chunkArrayLs","splitArraytoParts","getFavoritCardsFromLocalStorage","cards","renderPagination","favoriteInfoLs","chunkArrayLocal","id","allstorage","isExerciseInFavorite","removeExerciseFromFavoriteById","error","exerciseInfo","createMarkupModalEx","e","getCurrentPage","event","closeIconUse","closeModalOnEscape","closeExerciseModal","closeModalOnMouse"],"mappings":"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"}